<!DOCTYPE html>
<html>
<head>
    <title>Home - Cheav Por Chea Website</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">

    <!-- Only load THREE.js once with non-module version -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r137/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r137/examples/js/loaders/STLLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r137/examples/js/controls/OrbitControls.js"></script>
</head>

<body>
    <div>
        <h1>C.P. Chea's Blog</h1>
        <nav class="navbar">
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <div class="dropdown">
                    <button class="dropbtn">Publications <i class="fa fa-caret-down"></i></button>
                    <div class="dropdown-content">
                        <a href="/pub_robotic">Robotic Construction</a>
                        <a href="/pub_structure">Structural Engineering</a>
                        <a href="/pub_seismic">Seismic Engineering</a>
                    </div>
                </div>
                <li><a href="/projects">Projects</a></li>
                <li><a href="/awards">Honors & Awards</a></li>
                <li><a href="/documentations">Documentations</a></li>
                <li><a href="/about">About Me</a></li>
            </ul>
        </nav>
    </div>

    <div class="background-container">
        <div>
            <iframe width="560" height="315" src="https://www.youtube.com/embed/69mJ5CEKS80" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
            </iframe>
        </div>
        <div class="text-content">
            <h2>Robotic Construction For Reciprocal Frame Structure</h2>
            <p> ... </p> <!-- keep your original text -->
        </div>
    </div>

    <div class="background-container">
        <div>
            <iframe width="560" height="315" src="https://www.youtube.com/embed/RBxy8IXPTz4?si=fSoDB9KLnrhpns5O"
                    frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="text-content">
            <h2>Site activities assisted by construction robots</h2>
            <p> ... </p>
        </div>
    </div>

    <div class="background-container">
        <div>
            <iframe width="560" height="315" src="https://www.youtube.com/embed/xt2ayJi6GDc" frameborder="0"
                    allowfullscreen></iframe>
        </div>
        <div class="text-content">
            <h2>Paving robot</h2>
            <p> ... </p>
        </div>
    </div>

    <!-- 3D model block -->
    <div class="background-container">
        <div>
            <h2>3D Model: House</h2>
            <div id="stlViewer" style="width: 600px; height: 400px;"></div>
        </div>
    </div>

    <!-- Three.js 3D STL loading code -->
    <script>
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, 600 / 400, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(600, 400);
        document.getElementById('stlViewer').appendChild(renderer.domElement);

        const ambientLight = new THREE.AmbientLight(0x404040, 2);
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
        directionalLight.position.set(0, 1, 1).normalize();
        scene.add(directionalLight);

        const controls = new THREE.OrbitControls(camera, renderer.domElement);

        const loader = new THREE.STLLoader();
        loader.load('/static/House.stl', function (geometry) {
            const material = new THREE.MeshPhongMaterial({ color: 0x5588ff, specular: 0x111111, shininess: 200 });
            const mesh = new THREE.Mesh(geometry, material);
            scene.add(mesh);
            mesh.rotation.x = -Math.PI / 2;

            // Auto center the camera on loaded model
            const box = new THREE.Box3().setFromObject(mesh);
            const center = box.getCenter(new THREE.Vector3());
            controls.target.copy(center);
            controls.update();
        });

        camera.position.z = 5;

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
